package co.coderiver.vjprithivi.ui;import android.content.Intent;import android.os.Bundle;import android.support.v7.app.AppCompatActivity;import android.support.v7.widget.Toolbar;import android.view.View;import android.widget.AdapterView;import android.widget.Button;import android.widget.CompoundButton;import android.widget.EditText;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.ScrollView;import android.widget.Spinner;import android.widget.Switch;import android.widget.TextView;import com.bumptech.glide.Glide;import com.facebook.AccessToken;import com.facebook.AccessTokenTracker;import com.facebook.CallbackManager;import com.facebook.FacebookCallback;import com.facebook.FacebookException;import com.facebook.FacebookSdk;import com.facebook.Profile;import com.facebook.login.LoginResult;import com.facebook.login.widget.LoginButton;import co.coderiver.vjprithivi.R;import co.coderiver.vjprithivi.util.IntentUtil;import co.coderiver.vjprithivi.util.PrefUtil;/** * Created by vjprithivi on 6/12/2016. */public class next extends AppCompatActivity implements View.OnClickListener {    String email, name, s1, s2, s3, studies, h;    Spinner sp;    ScrollView id;    LinearLayout l1;    Button Register;    EditText t, a, b, c, d, emails, e, t1, t2, t3, t4;    private Toolbar toolbar;    private Switch toggleButton1, toggleButton2, toggleButton3;    private TextView info, text, kk;    private ImageView profileImgView;    private LoginButton loginButton;    private PrefUtil prefUtil;    private IntentUtil intentUtil;    private CallbackManager callbackManager;    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        FacebookSdk.sdkInitialize(getApplicationContext());        callbackManager = CallbackManager.Factory.create();        setContentView(R.layout.layout);/*        toolbar = (Toolbar) findViewById(R.id.action_bar);        setSupportActionBar(toolbar);*/        prefUtil = new PrefUtil(this);        intentUtil = new IntentUtil(this);      /*  info = (TextView) findViewById(R.id.info);        profileImgView = (ImageView) findViewById(R.id.profile_img);*/    /*    Bitmap icon = BitmapFactory.decodeResource(getResources(),R.mipmap.conta);        profileImgView.setImageBitmap(icon);*/        loginButton = (LoginButton) findViewById(R.id.login_button);        text = (TextView) findViewById(R.id.textView);        toggleButton1 = (Switch) findViewById(R.id.switch1);        toggleButton2 = (Switch) findViewById(R.id.switch2);        toggleButton3 = (Switch) findViewById(R.id.switch3);        t2 = (EditText) findViewById(R.id.nameofunviversity);        t3 = (EditText) findViewById(R.id.towncity);        t4 = (EditText) findViewById(R.id.postcode);        a = (EditText) findViewById(R.id.Name);        b = (EditText) findViewById(R.id.dateofbrith);        c = (EditText) findViewById(R.id.Nationality);        emails = (EditText) findViewById(R.id.Email);        d = (EditText) findViewById(R.id.mobile);        Register = (Button) findViewById(R.id.Register);        sp = (Spinner) findViewById(R.id.whattypeofstudy);        Register.setOnClickListener(this);        s1 = toggleButton1.getTextOff().toString();        s2 = toggleButton2.getTextOff().toString();        s3 = toggleButton3.getTextOff().toString();        a.setVisibility(View.GONE);        b.setVisibility(View.GONE);        c.setVisibility(View.GONE);        d.setVisibility(View.GONE);        sp.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {            @Override            public void onItemSelected(AdapterView<?> arg0, View arg1,                                       int arg2, long arg3) {                studies = arg0.getItemAtPosition(arg2).toString();                // Toast.makeText(MainActivity.this, "Selected: " + sex,                // Toast.LENGTH_SHORT).show();            }            @Override            public void onNothingSelected(AdapterView<?> arg0) {                // TODO Auto-generated method stub                // Toast.makeText(MainActivity.this, "No Selection",                // Toast.LENGTH_SHORT).show();            }        });        toggleButton1.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {            @Override            public void onCheckedChanged(CompoundButton buttonView,                                         boolean isChecked) {                if (toggleButton1.isChecked()) {                    s1 = toggleButton1.getTextOn().toString();                    s1.toString();                } else {                    s1 = toggleButton1.getTextOff().toString();                }            }        });        toggleButton2.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {            @Override            public void onCheckedChanged(CompoundButton buttonView,                                         boolean isChecked) {                if (isChecked) {                    s2 = toggleButton2.getTextOn().toString();                } else {                    s2 = toggleButton2.getTextOff().toString();                }            }        });        toggleButton3.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {            @Override            public void onCheckedChanged(CompoundButton buttonView,                                         boolean isChecked) {                if (isChecked) {                    s3 = toggleButton3.getTextOn().toString();                    a.setVisibility(View.VISIBLE);                    b.setVisibility(View.VISIBLE);                    c.setVisibility(View.VISIBLE);                    d.setVisibility(View.VISIBLE);                } else {                    s3 = toggleButton3.getTextOff().toString();                    a.setVisibility(View.GONE);                    b.setVisibility(View.GONE);                    c.setVisibility(View.GONE);                    d.setVisibility(View.GONE);                }            }        });        loginButton.registerCallback(callbackManager, new FacebookCallback<LoginResult>() {            @Override            public void onSuccess(LoginResult loginResult) {               /* Profile profile = Profile.getCurrentProfile();                info.setText(message(profile));*/                String userId = loginResult.getAccessToken().getUserId();                String accessToken = loginResult.getAccessToken().getToken();                // save accessToken to SharedPreference                prefUtil.saveAccessToken(accessToken);            }            @Override            public void onCancel() {            }            @Override            public void onError(FacebookException e) {            }        });    }    @Override    public void onResume() {        super.onResume();        deleteAccessToken();    }    @Override    protected void onActivityResult(int requestCode, int resultCode, Intent data) {        callbackManager.onActivityResult(requestCode, resultCode, data);    }    private void deleteAccessToken() {        AccessTokenTracker accessTokenTracker = new AccessTokenTracker() {            @Override            protected void onCurrentAccessTokenChanged(                    AccessToken oldAccessToken,                    AccessToken currentAccessToken) {                if (currentAccessToken == null) {                    //User logged out                    prefUtil.clearToken();                    clearUserArea();                    Intent i = new Intent(next.this, MainActivity.class);                    startActivity(i);                }            }        };    }    private void clearUserArea() {       /* info.setText("");        profileImgView.setImageDrawable(null);*/    }    private void check() {        Intent nextScreen = new Intent(getApplicationContext(), getClass());        //Sending data to another Activity        nextScreen.putExtra("name", toggleButton1.getTextOn().toString());        startActivity(nextScreen);        Intent i = getIntent();        String name = i.getStringExtra("name");        text.setText(name);    }    private void sendEmail() {        //Getting content for email        String e1 = t1.getText().toString().trim();        String e2 = t2.getText().toString().trim();        String e3 = t3.getText().toString().trim();        String e4 = t4.getText().toString().trim();        String email = emails.getText().toString().trim();        String subject = getString(R.string.subject);        String name = a.getText().toString().trim();        String Dateofbrith = b.getText().toString().trim();        String mobile = d.getText().toString().trim();        String nationality = c.getText().toString().trim();        SendMail sm = new SendMail(this, email, subject, Dateofbrith, nationality, e1, e2, e3, e4, s1, s2, s3, name, mobile, studies);        sm.execute();    }    private void twomail() {        //Getting content for email        String e1 = t1.getText().toString().trim();        String e2 = t2.getText().toString().trim();        String e3 = t3.getText().toString().trim();        String e4 = t4.getText().toString().trim();        String email = emails.getText().toString().trim();        String subject = getString(R.string.subject);        String name = a.getText().toString().trim();        String Dateofbrith = b.getText().toString().trim();        String mobile = d.getText().toString().trim();        String nationality = c.getText().toString().trim();        /*String  message  = new String();        message.contains("Message:"+t.getText().toString()+"\n"+"date:"+a.getText().toString());*/        //Creating SendMail object        SendMail sm = new SendMail(this, email, subject, Dateofbrith, nationality, e1, e2, e3, e4, s1, s2, s3, name, mobile, studies);        //Executing SendMail to send email        sm.execute();    }    @Override    public void onClick(View view) {        sendEmail();        twomail();    }  /*  private String message(Profile profile) {      *//*  StringBuilder stringBuffer = new StringBuilder();        if (profile != null) {            stringBuffer.append("Welcome ").append(profile.getName());        }        return stringBuffer.toString();*//*    }*/}